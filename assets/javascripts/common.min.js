var website=website||{};website.module=website.module||{},website.module.extendedFormatDate=function(t,e){var o={},n=t.getMinutes(),r=t.getHours(),g=t.getDate(),i=t.getMonth()+1,u=e.months[t.getMonth()],l=t.getFullYear();return n=(n.toString().length>1?"":"0")+n,r=(r.toString().length>1?"":"0")+r,g=(g.toString().length>1?"":"0")+g,i=(i.toString().length>1?"":"0")+i,o.string=e.toDate+" "+g+" "+u+" "+l+" "+e.toHour+" "+r+e.unitHours+n,o.time=l+"-"+i+"-"+g+"T"+r+":"+n+":00.000",o},"object"==typeof module&&(module.exports=website.module.extendedFormatDate);var website=website||{},$window=$(window),$document=$(document),$html=$("html"),$body=$("body"),$base=$("base");!function(t){"use strict";var e={};t.minified=$html.attr("class").indexOf("min")>-1?".min":"",t.jQueryUiLoading=function(e){Modernizr.load({test:0===$('script[src="javascripts/jquery/jquery-ui'+t.minified+'.js"]').length,yep:["stylesheets/jquery/jquery-ui"+t.minified+".css","javascripts/jquery/jquery-ui"+t.minified+".js","javascripts/jquery/jquery.timepicker"+t.minified+".js"],complete:function(){"function"==typeof e&&e()}})},t.jsHashesLoading=function(t){Modernizr.load({test:0===$('script[src="javascripts/hashes.min.js"]').length,yep:["javascripts/hashes.min.js"],complete:function(){"function"==typeof t&&t()}})},t.smartTargetInjection=function(){$(document.links).filter(function(){return!this.target}).filter(function(){return this.hostname!==window.location.hostname||/\.(?!html?|php3?|aspx?)([a-z]{0,3}|[a-zt]{0,4})$/.test(this.pathname)}).attr("target","_blank")},t.prettifyLoad=function(){var t=$(".prettyprint");prettyPrint(),t.mouseleave(function(){$.data(this,"draggable",!1),$.data(this,"offset",0)}).mousedown(function(t){$.data(this,"draggable",!0),$.data(this,"offset",t.pageX)}).mouseup(function(){$.data(this,"draggable",!1),$.data(this,"offset",0)}).mousemove(function(t){$(this).data("draggable")&&($(this).scrollLeft(parseInt($(this).scrollLeft()+($(this).data("offset")-t.pageX),10)),$.data(this,"offset",t.pageX))}).data("draggable",!1).data("offset",0)},t.disqusLoading=function(){var t="lesieur",e=$("article.article").data("urn"),a=$(".permalink span").text().split("?")[0];0!==$("article.article").length&&Modernizr.load({test:0===$('script[src="//'+t+'.disqus.com/embed.js"]').length,yep:"//"+t+".disqus.com/embed.js",complete:function(){DISQUS.reset({reload:!0,config:function(){this.page.identifier=e,this.page.url=a}})}})},t.disqusNumberLoading=function(){var t,e="&1=",a="/count-data.js",i=$("a[data-disqus-identifier]");i.length>0&&(i.each(function(){a=a+e+$(this).data("disqus-identifier")}),t={host:"lesieur.disqus.com",path:a.replace(/^\/count-data.js&/g,"/count-data.js?")+"&random="+1e4*Math.random()},NA.socket.emit("update-comment-number",t),NA.socket.on("update-comment-number",function(t){for(var e=0;e<t.counts.length;e++)$("a[data-disqus-identifier="+t.counts[e].id+"]").each(function(){$(this).find(".set-number").text(t.counts[e].comments),t.counts[e].comments>1?$(this).find("[data-ins]").text($(this).find("[data-ins]").data("ins")):$(this).find("[data-ins]").text("")})}))},t.googleAnalytics=function(){!function(t,e,a,i,n,o,s){t.GoogleAnalyticsObject=n,t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},t[n].l=1*new Date,o=e.createElement(a),s=e.getElementsByTagName(a)[0],o.async=1,o.src=i,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-51063761-1","lesieur.name"),ga("require","displayfeatures"),ga("send","pageview")},e.lastScrollValue=0,t.scrollAsideSynchonisation=function(){$document.scroll(function(){var t=$(".to-know");t.scrollTop(t.scrollTop()+($document.scrollTop()-e.lastScrollValue)/2),e.lastScrollValue=$document.scrollTop()})},t.autoTarget=function(){$(document.links).filter(function(){return!this.target}).filter(function(){return this.hostname!==window.location.hostname||/\.([a-z]{0,3}|[a-zt]{0,4})$/.test(this.pathname)}).attr("target","_blank")},t.kc=function(){var t=document.createElement("script"),a=document.getElementsByTagName("body")[0];t.type="text/javascript",t.addEventListener("load",function(){new KonamiCode(function(){e.kc?(e.kc=!1,a.style="overflow-x: hidden;transition: transform 2s ease;transform: rotate(0deg)"):(e.kc=!0,a.style="overflow-x: hidden;transition: transform 2s ease;transform: rotate(180deg)")})}),t.src="https://cdn.rawgit.com/Haeresis/konami-code-js/master/src/konami-code.js",a.appendChild(t)},t.init=function(){t.googleAnalytics(),t.disqusNumberLoading(),t.scrollAsideSynchonisation(),t.autoTarget(),t.smartTargetInjection(),t.kc()}}(website),function(t){"use strict";var e={};e.uploadImage=function(){var t=$(".form-upload-avatar"),e=$(".image-upload-avatar"),a=$(".file-upload-avatar"),i=$(".button-upload-avatar");i.click(function(){""!==a&&t.submit()}),t.submit(function(t){t.preventDefault(),$(this).ajaxSubmit({error:function(t){console.log("Error: "+t.status)},success:function(t){e.attr("src",$base.attr("href")+t.url),a.attr("data-url",t.url)}})})},e.createArticle=function(){$(".create-article-button").click(function(t){t.preventDefault();var e=$(this);e.addClass("loading"),NA.socket.emit("create-article-button",{title:$("#create-article-title").val(),urn:$(".no-article").data("urn")})})},e.deleteArticle=function(){var t=$(".delete-article-button");t.click(function(e){e.preventDefault();var a=window.prompt(t.data("prompt"),"Oui");"oui"===a.toLowerCase()&&(t.addClass("loading"),NA.socket.emit("delete-article-button",{urn:$("article.article").data("urn")}))})},e.listeningDeleteArticle=function(){NA.socket.on("delete-article-button",function(t){location.href=$base.attr("href")+t.urn+"/"})},e.updateArticle=function(){function t(t){t.parents("li:first").remove()}var e,a,i,n,o=$(".content h1"),s=$(".text"),r=$(".categories h3"),c=$(".categories li"),l=$(".published a"),d=$("article.article"),u=$(".script"),f=$(".stylesheet"),p=$('<select class="field-categories">'),h=".categories select option",m=$(".categories ul");NA.socket.on("update-article-load-content",function(g){o.after($('<input type="text" class="field-title like-h1" placeholder="Titre">').val(o.html())).css("display","none"),s.after($('<textarea class="field-script" cols="30" rows="10" placeholder="Script">')).css("display","none"),$(".field-script").val(u.html()),s.after($('<textarea class="field-stylesheet" cols="30" rows="10" placeholder="Stylesheet">')).css("display","none"),$(".field-stylesheet").val(f.html()),s.after('<span class="field-published"><input type="checkbox"><label> Visible ?</label></span>'),e=$(".field-published input"),e.attr("checked","true"===d.attr("data-published")),s.after('<span class="field-markdown"><input type="checkbox"><label> Markdown ?</label></span>'),a=$(".field-markdown input"),a.attr("checked","true"===d.attr("data-markdown")),$(".field-markdown, .field-published").each(function(){var t=$(this);t.hasClass("field-markdown")&&"true"===d.attr("data-markdown")&&t.addClass("checked"),t.hasClass("field-published")&&"true"===d.attr("data-published")&&t.addClass("checked")}).click(function(){var t=$(this);t.hasClass("checked")?(t.removeClass("checked"),t.find("input").prop("checked",!1)):(t.addClass("checked"),t.find("input").prop("checked",!0))}),s.after($('<textarea class="field-content" cols="30" rows="30" placeholder="Article">')).css("display","none"),$(".field-content").val(g.content),p.find("option").remove(),p.append($('<option value="">').text("----"));for(var v=0;v<g.categories.length;v++)p.append($('<option value="'+g.categories[v].urn+'">').text(g.categories[v].title));r.append(p),p.change(function(){$(h+":selected").each(function(){var e=$(this),a=!1,i=$(".categories li");""!==e.val()&&(a=!0,i.each(function(t){i.eq(t).data("urn")===e.val()&&(a=!1)}),a&&(n=$('<li data-urn="'+e.val()+'">').html('<a href="'+m.data("url").replace(/%urn%/g,e.val())+'" title="'+m.data("title")+" "+e.text()+'">'+e.text()+"</a><strong> X</strong></li>"),m.append(n),n.find("strong").click(function(){t($(this))})),$(h).removeAttr("selected"),$(h+'[value=""]').attr("selected","selected"))})}),c.append($("<strong>").text(" X")),i=$(".categories li strong"),i.click(function(){t($(this))}),website.jQueryUiLoading(function(){l.after($('<input type="text" class="field-date" placeholder="Date">').val(l.find("time").attr("datetime").replace("T"," ").replace(".000",""))).css("display","none"),m.sortable(),$(".field-date").datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:00",changeMonth:!0,changeYear:!0}),$(".update-article-button").removeClass("loading")})}),$(".update-article-button").click(function(t){t.preventDefault();var i,n,o,s,r,c=$(this),l=[],u=$(".categories li");c.addClass("loading"),c.data("state")?(i=$(".field-title"),n=$(".field-content"),o=$(".field-date"),s=$(".field-script"),r=$(".field-stylesheet"),u.each(function(t){l.push(u.eq(t).data("urn"))}),NA.socket.emit("update-article-button",{urn:d.data("urn"),title:i.val(),content:n.val(),script:s.val(),stylesheet:r.val(),publishedDate:o.val(),categories:l,published:e.prop("checked"),markdown:a.prop("checked"),permalink:$(".permalink span").text()}),c.data("state",!1)):(c.data("state",!0),NA.socket.emit("update-article-load-content",{urn:d.data("urn")}))})},e.listeningCreateArticle=function(){NA.socket.on("create-article-button",function(t){location.href=$base.attr("href")+t.urn+"/"})},e.listeningUpdateArticle=function(){var t=$(".content h1"),e=$("title"),a=$(".text"),i=$(".script"),n=$(".stylesheet"),o=$("article.article"),s=$(".published a"),r=$(".permalink span");NA.socket.on("update-article-button-all",function(c){var l,d=new Date(c.publishedDate.replace(/ /g,"T")+".000+02:00"),u=website.module.extendedFormatDate(d,c.variation.dates),f=d.getMonth()+1,p=c.variation.listDate.linkMonth.title.replace(/%year%/g,d.getFullYear()).replace(/%month%/g,c.variation.dates.months[d.getMonth()]);r.text()===c.permalink&&(f=(f.toString().length>1?"":"0")+f,l=c.variation.listDate.linkMonth.href.replace(/%year%/g,d.getFullYear()).replace(/%month%/g,f),0!==o.length&&(e.text(c.title.replace(/<\/?span>/g,"")),t.html(c.title),a.html(c.content)),s.find("time").html(u.string),s.find("time").attr("datetime",u.time),s.attr("title",p),s.attr("href",l),o.attr("data-markdown",c.markdown),o.attr("data-published",c.published),n.html(c.stylesheet),i.html(c.script),c.script&&(i.after($('<script class="script" type="text/javascript">').html(c.script)),i.remove()),website.prettifyLoad(),website.autoTarget())}),NA.socket.on("update-article-button-others",function(t){var e=$("article.article");0!==e.length?t.published.toString()!==e.attr("data-published").toString()&&location.reload():t.published&&location.reload()}),NA.socket.on("update-article-button",function(){var e=$(".field-title"),i=$(".field-content"),n=$(".field-date"),o=$(".field-markdown"),r=$(".field-published"),c=$(".field-script"),l=$(".field-stylesheet"),d=$(".field-categories"),u=$(".categories li strong");t.css("display",""),a.css("display",""),s.css("display",""),e.remove(),i.remove(),n.remove(),r.remove(),c.remove(),l.remove(),d.remove(),u.remove(),o.remove(),$(".update-article-button").removeClass("loading")})},e.treeOfHeaders=function(t,a){function i(){"undefined"!=typeof n[o]&&"undefined"!=typeof n[o].headers&&(n[o].headers=e.treeOfHeaders(n[o].headers,a+1))}for(var n=[],o=-1,s=0;s<t.length;s++)t[s][0].nodeName==="H"+a&&(i(),o++,"undefined"==typeof n[o]&&(n[o]={}),n[o].header=t[s]),"undefined"!=typeof n[o]&&t[s][0].nodeName!=="H"+a&&("undefined"==typeof n[o].headers&&(n[o].headers=[]),n[o].headers.push(t[s]));return i(),n},e.constructSummary=function(t,a){for(var i,n,o,s=0;s<t.length;s++)o=$("<a>"),n=$("<li>"),i=$("<ul>"),o.text(t[s].header.text()),o.attr("title",t[s].header.text()),"H1"!==t[s].header[0].nodeName?o.attr("href",$(".permalink span").text()+"#"+t[s].header.attr("id")):o.attr("href",$(".permalink span").text()+"#content"),n.append(o),i.append(n),a.append(i),t[s].headers&&e.constructSummary(t[s].headers,n)},e.summary=function(){var t=[];$("article h1, article h2, article h3, article h4, article h5, article h6").each(function(){t.push($(this))}),e.constructSummary(e.treeOfHeaders(t,1),$(".summary"))},t.init=function(){e.createArticle(),e.listeningCreateArticle(),e.updateArticle(),e.listeningUpdateArticle(),e.deleteArticle(),e.listeningDeleteArticle(),website.prettifyLoad(),e.summary(),website.disqusLoading(),website.script&&website.script()}}(website.article={}),function(t){"use strict";var e={};e.accountLogin=function(){$(".account-login-button").click(function(t){t.preventDefault(),$(this).addClass("loading"),website.jsHashesLoading(function(){var t={email:$("#account-login-email").val(),password:(new Hashes.SHA1).hex($("#account-login-password").val())};NA.socket.emit("account-login",t)})})},e.listeningAccountLogin=function(){NA.socket.on("account-login",function(t){t.authSuccess?location.reload():($(".account-login-button").removeClass("loading"),$(".submit .errors ").show())})},e.accountLogout=function(){$(".account-logout-button").click(function(t){website.isEditable||(t.preventDefault(),$(this).addClass("loading"),NA.socket.emit("account-logout",{}))})},e.listeningAccountLogout=function(){NA.socket.on("account-logout",function(t){location.reload()})},t.init=function(){e.accountLogin(),e.listeningAccountLogin(),e.accountLogout(),e.listeningAccountLogout()}}(website.login={}),$(function(){"use strict";var t=$body.attr("class").split(" ")[0].replace(/-/g,"");website.init(),void 0!==website[t]&&website[t].init()});