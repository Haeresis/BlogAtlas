var website=website||{};website.module=website.module||{},website.module.extendedFormatDate=function(t,e){var o={},n=t.getMinutes(),r=t.getHours(),g=t.getDate(),i=t.getMonth()+1,u=e.months[t.getMonth()],l=t.getFullYear();return n=(n.toString().length>1?"":"0")+n,r=(r.toString().length>1?"":"0")+r,g=(g.toString().length>1?"":"0")+g,i=(i.toString().length>1?"":"0")+i,o.string=e.toDate+" "+g+" "+u+" "+l+" "+e.toHour+" "+r+e.unitHours+n,o.time=l+"-"+i+"-"+g+"T"+r+":"+n+":00.000",o},"object"==typeof module&&(module.exports=website.module.extendedFormatDate);var website=website||{},$window=$(window),$document=$(document),$html=$("html"),$body=$("body"),$base=$("base");!function(e){"use strict";var t={};e.minified=$html.attr("class").indexOf("min")>-1?".min":"",e.jQueryUiLoading=function(t){Modernizr.load({test:0===$('script[src="javascripts/jquery/jquery-ui'+e.minified+'.js"]').length,yep:["stylesheets/jquery/jquery-ui"+e.minified+".css","javascripts/jquery/jquery-ui"+e.minified+".js","javascripts/jquery/jquery.timepicker"+e.minified+".js"],complete:function(){"function"==typeof t&&t()}})},e.jsHashesLoading=function(e){Modernizr.load({test:0===$('script[src="javascripts/hashes.min.js"]').length,yep:["javascripts/hashes.min.js"],complete:function(){"function"==typeof e&&e()}})},e.smartTargetInjection=function(){$(document.links).filter(function(){return!this.target}).filter(function(){return this.hostname!==window.location.hostname||/\.(?!html?|php3?|aspx?)([a-z]{0,3}|[a-zt]{0,4})$/.test(this.pathname)}).attr("target","_blank")},e.prettifyLoad=function(){var e=$(".prettyprint");prettyPrint(),e.mouseleave(function(){$.data(this,"draggable",!1),$.data(this,"offset",0)}).mousedown(function(e){$.data(this,"draggable",!0),$.data(this,"offset",e.pageX)}).mouseup(function(){$.data(this,"draggable",!1),$.data(this,"offset",0)}).mousemove(function(e){$(this).data("draggable")&&($(this).scrollLeft(parseInt($(this).scrollLeft()+($(this).data("offset")-e.pageX),10)),$.data(this,"offset",e.pageX))}).data("draggable",!1).data("offset",0)},e.disqusLoading=function(){var e="lesieur",t=$("article.article").data("urn"),a=$(".permalink span").text().split("?")[0];0!==$("article.article").length&&Modernizr.load({test:0===$('script[src="//'+e+'.disqus.com/embed.js"]').length,yep:"//"+e+".disqus.com/embed.js",complete:function(){DISQUS.reset({reload:!0,config:function(){this.page.identifier=t,this.page.url=a}})}})},e.disqusNumberLoading=function(){var e=document.createElement("script");e.id="dsq-count-scr",e.async=!0,e.src="//lesieur.disqus.com/count.js",document.body.appendChild(e)},e.googleAnalytics=function(){var e,t,a,i,n,s;e=window,t=document,a="script",i="ga",e.GoogleAnalyticsObject=i,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,n=t.createElement(a),s=t.getElementsByTagName(a)[0],n.async=1,n.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(n,s),ga("create","UA-51063761-1","lesieur.name"),ga("require","displayfeatures"),ga("send","pageview")},t.lastScrollValue=0,e.scrollAsideSynchonisation=function(){$document.scroll(function(){var e=$(".to-know");e.scrollTop(e.scrollTop()+($document.scrollTop()-t.lastScrollValue)/2),t.lastScrollValue=$document.scrollTop()})},e.autoTarget=function(){$(document.links).filter(function(){return!this.target}).filter(function(){return this.hostname!==window.location.hostname||/\.([a-z]{0,3}|[a-zt]{0,4})$/.test(this.pathname)}).attr("target","_blank")},e.kc=function(){var e=document.createElement("script"),a=document.getElementsByTagName("body")[0];e.type="text/javascript",e.addEventListener("load",function(){new KonamiCode(function(){t.kc?(t.kc=!1,a.style="overflow-x: hidden;transition: transform 2s ease;transform: rotate(0deg)"):(t.kc=!0,a.style="overflow-x: hidden;transition: transform 2s ease;transform: rotate(180deg)")})}),e.src="https://cdn.rawgit.com/Haeresis/konami-code-js/master/src/konami-code.js",a.appendChild(e)},e.chat=function(){var e=document.createElement("script");window.gitter={chat:{options:{room:document.getElementById("channel").getAttribute("data-channel")}}},e.src="https://sidecar.gitter.im/dist/sidecar.v1.js",document.body.appendChild(e),function e(){var t=document.getElementsByClassName("gitter-open-chat-button")[0];t?(t.innerHTML='<span class="fa fa-comments" aria-hidden="true"></span> '+document.getElementById("channel").getAttribute("data-label"),t.classList.add("is-displayed")):setTimeout(e,200)}()},e.toggleMenu=function(){var e=document.getElementsByClassName("menu")[0],t=document.getElementsByClassName("main")[0];e.addEventListener("click",function(){e.classList.toggle("is-displayed"),t.classList.contains("is-displayed")?(t.classList.remove("is-displayed"),setTimeout(function(){t.style["z-index"]=-1},1e3)):(t.classList.add("is-displayed"),t.style["z-index"]=3)})},e.init=function(){e.googleAnalytics(),e.disqusNumberLoading(),e.scrollAsideSynchonisation(),e.autoTarget(),e.smartTargetInjection(),e.toggleMenu(),e.chat(),e.kc()}}(website),function(e){"use strict";var t={uploadImage:function(){var e=$(".form-upload-avatar"),t=$(".image-upload-avatar"),a=$(".file-upload-avatar");$(".button-upload-avatar").click(function(){""!==a&&e.submit()}),e.submit(function(e){e.preventDefault(),$(this).ajaxSubmit({error:function(e){console.log("Error: "+e.status)},success:function(e){t.attr("src",$base.attr("href")+e.url),a.attr("data-url",e.url)}})})},createArticle:function(){$(".create-article-button").click(function(e){e.preventDefault(),$(this).addClass("loading"),NA.socket.emit("create-article-button",{title:$("#create-article-title").val(),urn:$(".no-article").data("urn")})})},deleteArticle:function(){var e=$(".delete-article-button");e.click(function(t){t.preventDefault(),"oui"===window.prompt(e.data("prompt"),"Oui").toLowerCase()&&(e.addClass("loading"),NA.socket.emit("delete-article-button",{urn:$("article.article").data("urn")}))})},listeningDeleteArticle:function(){NA.socket.on("delete-article-button",function(e){location.href=$base.attr("href")+e.urn+"/"})},updateArticle:function(){var e,t,a,i=$(".content h1"),n=$("meta[name='og:image']"),s=$("meta[name='og:description']"),o=$(".text"),r=$(".categories h3"),c=$(".categories li"),l=$(".article .comments"),d=$(".published a"),u=$("article.article"),p=$(".script"),f=$(".stylesheet"),m=$('<select class="field-categories">'),h=".categories select option",g=$(".categories ul");function v(e){e.parents("li:first").remove()}NA.socket.on("update-article-load-content",function(b){i.after($('<input type="text" class="field-title like-h1" placeholder="Titre">').val(i.html())).css("display","none"),l.before($('<input type="text" class="field-description like-h1" placeholder="Description">').val(s.attr("content"))).css("display","none"),l[0].insertAdjacentHTML("beforebegin"," "),l.before($('<input type="text" class="field-image like-h1" placeholder="Lien Image">').val(n.attr("content"))).css("display","none"),o.after($('<textarea class="field-script" cols="30" rows="10" placeholder="Script">')).css("display","none"),$(".field-script").val(p.html()),o.after($('<textarea class="field-stylesheet" cols="30" rows="10" placeholder="Stylesheet">')).css("display","none"),$(".field-stylesheet").val(f.html()),o.after('<span class="field-published"><input type="checkbox"><label> Visible ?</label></span>'),(e=$(".field-published input")).attr("checked","true"===u.attr("data-published")),o.after('<span class="field-markdown"><input type="checkbox"><label> Markdown ?</label></span>'),(t=$(".field-markdown input")).attr("checked","true"===u.attr("data-markdown")),$(".field-markdown, .field-published").each(function(){var e=$(this);e.hasClass("field-markdown")&&"true"===u.attr("data-markdown")&&e.addClass("checked"),e.hasClass("field-published")&&"true"===u.attr("data-published")&&e.addClass("checked")}).click(function(){var e=$(this);e.hasClass("checked")?(e.removeClass("checked"),e.find("input").prop("checked",!1)):(e.addClass("checked"),e.find("input").prop("checked",!0))}),o.after($('<textarea class="field-content" cols="30" rows="30" placeholder="Article">')).css("display","none"),$(".field-content").val(b.content),m.find("option").remove(),m.append($('<option value="">').text("----"));for(var y=0;y<b.categories.length;y++)m.append($('<option value="'+b.categories[y].urn+'">').text(b.categories[y].title));r.append(m),m.change(function(){$(h+":selected").each(function(){var e=$(this),t=!1,i=$(".categories li");""!==e.val()&&(t=!0,i.each(function(a){i.eq(a).data("urn")===e.val()&&(t=!1)}),t&&(a=$('<li data-urn="'+e.val()+'">').html('<a href="'+g.data("url").replace(/%urn%/g,e.val())+'" title="'+g.data("title")+" "+e.text()+'">'+e.text()+"</a><strong> X</strong></li>"),g.append(a),a.find("strong").click(function(){v($(this))})),$(h).removeAttr("selected"),$(h+'[value=""]').attr("selected","selected"))})}),c.append($("<strong>").text(" X")),$(".categories li strong").click(function(){v($(this))}),website.jQueryUiLoading(function(){d.after($('<input type="text" class="field-date" placeholder="Date">').val(d.find("time").attr("datetime").replace("T"," ").replace(".000",""))).css("display","none"),g.sortable(),$(".field-date").datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:00",changeMonth:!0,changeYear:!0}),$(".update-article-button").removeClass("loading")})}),$(".update-article-button").click(function(a){a.preventDefault();var i,n,s,o,r,c,l,d=$(this),p=[],f=$(".categories li");d.addClass("loading"),d.data("state")?(i=$(".field-title"),n=$(".field-description"),s=$(".field-image"),o=$(".field-content"),r=$(".field-date"),c=$(".field-script"),l=$(".field-stylesheet"),f.each(function(e){p.push(f.eq(e).data("urn"))}),NA.socket.emit("update-article-button",{urn:u.data("urn"),title:i.val(),description:n.val(),image:s.val(),content:o.val(),script:c.val(),stylesheet:l.val(),publishedDate:r.val(),categories:p,published:e.prop("checked"),markdown:t.prop("checked"),permalink:$(".permalink span").text()}),d.data("state",!1)):(d.data("state",!0),NA.socket.emit("update-article-load-content",{urn:u.data("urn")}))})},listeningCreateArticle:function(){NA.socket.on("create-article-button",function(e){location.href=$base.attr("href")+e.urn+"/"})},listeningUpdateArticle:function(){var e=$(".content h1"),t=$("title"),a=$(".text"),i=$(".script"),n=$(".stylesheet"),s=$("article.article"),o=$(".published a"),r=$(".permalink span");NA.socket.on("update-article-button-all",function(c){var l,d=new Date(c.publishedDate),u=website.module.extendedFormatDate(d,c.variation.dates),p=d.getMonth()+1,f=c.variation.listDate.linkMonth.title.replace(/%year%/g,d.getFullYear()).replace(/%month%/g,c.variation.dates.months[d.getMonth()]);$("meta[name='description'], meta[name='og:description']").attr("content",c.description),$("meta[name='og:image']").attr("content",c.image),r.text()===c.permalink&&(p=(p.toString().length>1?"":"0")+p,l=c.variation.listDate.linkMonth.href.replace(/%year%/g,d.getFullYear()).replace(/%month%/g,p),0!==s.length&&(t.text(c.title.replace(/<\/?span>/g,"")),e.html(c.title),a.html(c.content)),o.find("time").html(u.string),o.find("time").attr("datetime",u.time),o.attr("title",f),o.attr("href",l),s.attr("data-markdown",c.markdown),s.attr("data-published",c.published),n.html(c.stylesheet),i.html(c.script),c.script&&(i.after($('<script class="script" type="text/javascript">').html(c.script)),i.remove()),website.prettifyLoad(),website.autoTarget())}),NA.socket.on("update-article-button-others",function(e){var t=$("article.article");0!==t.length?e.published.toString()!==t.attr("data-published").toString()&&location.reload():e.published&&location.reload()}),NA.socket.on("update-article-button",function(){var t=$(".field-title"),i=$(".field-description"),n=$(".field-image"),s=$(".field-content"),r=$(".field-date"),c=$(".field-markdown"),l=$(".field-published"),d=$(".field-script"),u=$(".field-stylesheet"),p=$(".field-categories"),f=$(".categories li strong");e.css("display",""),a.css("display",""),o.css("display",""),t.remove(),i.remove(),n.remove(),s.remove(),r.remove(),l.remove(),d.remove(),u.remove(),p.remove(),f.remove(),c.remove(),$(".update-article-button").removeClass("loading")})},treeOfHeaders:function(e,a){var i=[],n=-1;function s(){void 0!==i[n]&&void 0!==i[n].headers&&(i[n].headers=t.treeOfHeaders(i[n].headers,a+1))}for(var o=0;o<e.length;o++)e[o][0].nodeName==="H"+a&&(s(),void 0===i[++n]&&(i[n]={}),i[n].header=e[o]),void 0!==i[n]&&e[o][0].nodeName!=="H"+a&&(void 0===i[n].headers&&(i[n].headers=[]),i[n].headers.push(e[o]));return s(),i},constructSummary:function(e,a){for(var i,n,s,o=0;o<e.length;o++)s=$("<a>"),n=$("<li>"),i=$("<ul>"),s.text(e[o].header.text()),s.attr("title",e[o].header.text()),"H1"!==e[o].header[0].nodeName?s.attr("href",$(".permalink span").text()+"#"+e[o].header.attr("id")):s.attr("href",$(".permalink span").text()+"#content"),n.append(s),i.append(n),a.append(i),e[o].headers&&t.constructSummary(e[o].headers,n)},summary:function(){var e=[];$("article h1, article h2, article h3, article h4, article h5, article h6").each(function(){e.push($(this))}),t.constructSummary(t.treeOfHeaders(e,1),$(".summary"))}};(website.article={}).init=function(){t.createArticle(),t.listeningCreateArticle(),t.updateArticle(),t.listeningUpdateArticle(),t.deleteArticle(),t.listeningDeleteArticle(),website.prettifyLoad(),t.summary(),website.disqusLoading(),website.script&&website.script()}}(),function(e){"use strict";var t={accountLogin:function(){$(".account-login-button").click(function(e){e.preventDefault(),$(this).addClass("loading"),website.jsHashesLoading(function(){var e={email:$("#account-login-email").val(),password:(new Hashes.SHA1).hex($("#account-login-password").val())};NA.socket.emit("account-login",e)})})},listeningAccountLogin:function(){NA.socket.on("account-login",function(e){e.authSuccess?location.reload():($(".account-login-button").removeClass("loading"),$(".submit .errors ").show())})},accountLogout:function(){$(".account-logout-button").click(function(e){website.isEditable||(e.preventDefault(),$(this).addClass("loading"),NA.socket.emit("account-logout",{}))})},listeningAccountLogout:function(){NA.socket.on("account-logout",function(e){location.reload()})}};(website.login={}).init=function(){t.accountLogin(),t.listeningAccountLogin(),t.accountLogout(),t.listeningAccountLogout()}}(),function(e){"use strict";var t={search:function(){$(".search-button").click(function(e){var t=$(".form-search"),a=$(".search-query"),i=$(".form-search .errors");e.preventDefault(),console.log("haha"),""===a.val()?i.show():(i.hide(),$(this).addClass("loading"),t.submit())})}};(website.search={}).init=function(){t.search()}}(),$(function(){"use strict";var e=$body.attr("class").split(" ")[0].replace(/-/g,"");website.init(),void 0!==website[e]&&website[e].init()});