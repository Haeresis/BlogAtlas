var website=website||{};website.module=website.module||{},website.module.extendedFormatDate=function(a,b){var c={},d=a.getMinutes(),e=a.getHours(),f=a.getDate(),g=a.getMonth()+1,h=b.months[a.getMonth()],i=a.getFullYear();return d=(d.toString().length>1?"":"0")+d,e=(e.toString().length>1?"":"0")+e,f=(f.toString().length>1?"":"0")+f,g=(g.toString().length>1?"":"0")+g,c.string=b.toDate+" "+f+" "+h+" "+i+" "+b.toHour+" "+e+b.unitHours+d,c.time=i+"-"+g+"-"+f+"T"+e+":"+d+":00.000",c},"object"==typeof module&&(module.exports=website.module.extendedFormatDate);var website=website||{},$window=$(window),$html=$("html"),$body=$("body"),$base=$("base");!function(a){"use strict";a.minified=$html.attr("class").indexOf("min")>-1?".min":"",a.jQueryUiLoading=function(b){Modernizr.load({test:0===$('script[src="javascript/jquery/jquery-ui'+a.minified+'.js"]').length,yep:["stylesheets/jquery/jquery-ui"+a.minified+".css","javascript/jquery/jquery-ui"+a.minified+".js","javascript/jquery/jquery.timepicker"+a.minified+".js"],complete:function(){"function"==typeof b&&b()}})},a.prettifyLoad=function(){if(prettyPrint(),!Modernizr.touch){var a=$(".prettyprint").css("overflow","hidden");a.mousedown(function(a){$.data(this,"draggable",!0),$.data(this,"offset",a.pageX)}).mouseup(function(){$.data(this,"draggable",!1),$.data(this,"offset",0)}).mouseleave(function(){$.data(this,"draggable",!1),$.data(this,"offset",0)}).mousemove(function(a){$(this).data("draggable")&&($(this).scrollLeft(parseInt($(this).scrollLeft()+($(this).data("offset")-a.pageX),10)),$.data(this,"offset",a.pageX))}).data("draggable",!1).data("offset",0)}},a.disqusLoading=function(){var a="lesieur",b=$("article.article").data("urn"),c=$(".permalink span").text().split("?")[0];0!==$("article.article").length&&Modernizr.load({test:0===$('script[src="//'+a+'.disqus.com/embed.js"]').length,yep:"//"+a+".disqus.com/embed.js",complete:function(){DISQUS.reset({reload:!0,config:function(){this.page.identifier=b,this.page.url=c}})}})},a.init=function(){}}(website),function(a){"use strict";var b={},c=io.connect();b.uploadImage=function(){var a=$(".form-upload-avatar"),b=$(".image-upload-avatar"),c=$(".file-upload-avatar"),d=$(".button-upload-avatar");d.click(function(){""!==c&&a.submit()}),a.submit(function(a){a.preventDefault(),$(this).ajaxSubmit({error:function(a){console.log("Error: "+a.status)},success:function(a){b.attr("src",$base.attr("href")+a.url),c.attr("data-url",a.url)}})})},b.createArticle=function(){$(".create-article-button").click(function(){$(this),c.emit("create-article-button",{title:$("#create-article-title").val(),urn:$(".no-article").data("urn")})})},b.deleteArticle=function(){var a=$(".delete-article-button");a.click(function(){window.prompt(a.data("prompt"),""),c.emit("delete-article-button",{urn:$("article.article").data("urn")})})},b.listeningDeleteArticle=function(){c.on("delete-article-button",function(a){location.href=$base.attr("href")+a.urn+"/"})},b.updateArticle=function(){var f,g,a=$(".content h1"),b=$(".text"),d=$(".published a"),e=$("article.article");c.on("update-article-load-content",function(c){a.after($('<input type="text" class="field-title like-h1">').val(a.html())).css("display","none"),b.after('<span class="field-published"><input type="checkbox"> Visible ?</span>'),f=$(".field-published input"),f.attr("checked","true"===e.attr("data-published")),b.after('<span class="field-markdown"><input type="checkbox"> Markdown ?</span>'),g=$(".field-markdown input"),g.attr("checked","true"===e.attr("data-markdown")),b.after($('<textarea class="field-content" cols="30" rows="10"></textarea>').val(c.content)).css("display","none"),website.jQueryUiLoading(function(){d.after($('<input type="text" class="field-date">').val(d.find("time").attr("datetime").replace("T"," ").replace(".000",""))).css("display","none"),$(".field-date").datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:00",changeMonth:!0,changeYear:!0})})}),$(".update-article-button").click(function(){var b,d,h,a=$(this);a.data("state")?(b=$(".field-title"),d=$(".field-content"),h=$(".field-date"),c.emit("update-article-button",{urn:e.data("urn"),title:b.val(),content:d.val(),publishedDate:h.val(),published:f.prop("checked"),markdown:g.prop("checked")}),a.data("state",!1)):(a.data("state",!0),c.emit("update-article-load-content",{urn:e.data("urn")}))})},b.listeningCreateArticle=function(){c.on("create-article-button",function(a){location.href=$base.attr("href")+a.urn+"/"})},b.listeningUpdateArticle=function(){var a=$(".content h1"),b=$("title"),d=$(".text"),e=$("article.article"),f=$(".published a");c.on("update-article-button-all",function(c){var k,g=new Date(c.publishedDate.replace(/ /g,"T")+".000+01:00"),h=website.module.extendedFormatDate(g,c.variation.dates),i=g.getMonth()+1,j=c.variation.listDate.linkMonth.title.replace(/%year%/g,g.getFullYear()).replace(/%month%/g,c.variation.dates.months[g.getMonth()]);i=(i.toString().length>1?"":"0")+i,k=c.variation.listDate.linkMonth.href.replace(/%year%/g,g.getFullYear()).replace(/%month%/g,i),0!==e.length&&(b.text(c.title.replace(/<\/?span>/g,"")),a.html(c.title),d.html(c.content)),f.find("time").html(h.string),f.find("time").attr("datetime",h.time),f.attr("title",j),f.attr("href",k),e.attr("data-markdown",c.markdown),e.attr("data-published",c.published),website.prettifyLoad()}),c.on("update-article-button-others",function(a){var b=$("article.article");0!==b.length?a.published.toString()!==b.attr("data-published").toString()&&location.reload():a.published&&location.reload()}),c.on("update-article-button",function(){var b=$(".field-title"),c=$(".field-content"),e=$(".field-date"),g=$(".field-markdown"),h=$(".field-published");a.css("display",""),d.css("display",""),f.css("display",""),b.remove(),c.remove(),e.remove(),h.remove(),g.remove()})},a.init=function(){b.createArticle(),b.listeningCreateArticle(),b.updateArticle(),b.listeningUpdateArticle(),b.deleteArticle(),b.listeningDeleteArticle(),website.disqusLoading()}}(website.article={}),function(a){"use strict";var b={},c=io.connect();b.accountLogin=function(){$(".account-login-button").click(function(){var a={email:$("#account-login-email").val(),password:$("#account-login-password").val()};c.emit("account-login",a)})},b.listeningAccountLogin=function(){c.on("account-login",function(a){a.authSuccess?location.reload():$(".submit .errors ").show()})},b.accountLogout=function(){$(".account-logout-button").click(function(){c.emit("account-logout",{})})},b.listeningAccountLogout=function(){c.on("account-logout",function(){location.reload()})},a.init=function(){b.accountLogin(),b.listeningAccountLogin(),b.accountLogout(),b.listeningAccountLogout()}}(website.login={}),$(function(){"use strict";var a=$body.attr("class").split(" ")[0].replace(/-/g,"");website.init(),void 0!==website[a]&&website[a].init()});