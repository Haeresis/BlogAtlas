var website=website||{};website.module=website.module||{},website.module.extendedFormatDate=function(a,b){var c={},d=a.getMinutes(),e=a.getHours(),f=a.getDate(),g=a.getMonth()+1,h=b.months[a.getMonth()],i=a.getFullYear();return d=(d.toString().length>1?"":"0")+d,e=(e.toString().length>1?"":"0")+e,f=(f.toString().length>1?"":"0")+f,g=(g.toString().length>1?"":"0")+g,c.string=b.toDate+" "+f+" "+h+" "+i+" "+b.toHour+" "+e+b.unitHours+d,c.time=i+"-"+g+"-"+f+"T"+e+":"+d+":00.000",c},"object"==typeof module&&(module.exports=website.module.extendedFormatDate);var website=website||{},$window=$(window),$html=$("html"),$body=$("body"),$base=$("base");!function(a){"use strict";var c=io.connect();a.minified=$html.attr("class").indexOf("min")>-1?".min":"",a.jQueryUiLoading=function(b){Modernizr.load({test:0===$('script[src="javascript/jquery/jquery-ui'+a.minified+'.js"]').length,yep:["stylesheets/jquery/jquery-ui"+a.minified+".css","javascript/jquery/jquery-ui"+a.minified+".js","javascript/jquery/jquery.timepicker"+a.minified+".js"],complete:function(){"function"==typeof b&&b()}})},a.prettifyLoad=function(){if(prettyPrint(),!Modernizr.touch){var a=$(".prettyprint").css("overflow","hidden");a.mousedown(function(a){$.data(this,"draggable",!0),$.data(this,"offset",a.pageX)}).mouseup(function(){$.data(this,"draggable",!1),$.data(this,"offset",0)}).mouseleave(function(){$.data(this,"draggable",!1),$.data(this,"offset",0)}).mousemove(function(a){$(this).data("draggable")&&($(this).scrollLeft(parseInt($(this).scrollLeft()+($(this).data("offset")-a.pageX),10)),$.data(this,"offset",a.pageX))}).data("draggable",!1).data("offset",0)}},a.disqusLoading=function(){var a="lesieur",b=$("article.article").data("urn"),c=$(".permalink span").text().split("?")[0];0!==$("article.article").length&&Modernizr.load({test:0===$('script[src="//'+a+'.disqus.com/embed.js"]').length,yep:"//"+a+".disqus.com/embed.js",complete:function(){DISQUS.reset({reload:!0,config:function(){this.page.identifier=b,this.page.url=c}})}})},a.disqusNumberLoading=function(){var e,a="&1=",b="/count-data.js",d=$("a[data-disqus-identifier]");d.length>0&&(d.each(function(){b=b+a+$(this).data("disqus-identifier")}),e={host:"lesieur.disqus.com",path:b.replace(/^\/count-data.js&/g,"/count-data.js?")+"&random="+1e4*Math.random()},c.emit("update-comment-number",e),c.on("update-comment-number",function(a){for(var b=0;b<a.counts.length;b++)$("a[data-disqus-identifier="+a.counts[b].id+"]").each(function(){$(this).find("span").text(a.counts[b].comments),a.counts[b].comments>1?$(this).find("ins").text($(this).find("ins").data("ins")):$(this).find("ins").text("")})}))},a.googleAnalytics=function(){!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-51063761-1","lesieur.name"),ga('require', 'displayfeatures'),ga("send","pageview")},a.init=function(){a.googleAnalytics(),a.disqusNumberLoading()}}(website),function(a){"use strict";var b={},c=io.connect();b.uploadImage=function(){var a=$(".form-upload-avatar"),b=$(".image-upload-avatar"),c=$(".file-upload-avatar"),d=$(".button-upload-avatar");d.click(function(){""!==c&&a.submit()}),a.submit(function(a){a.preventDefault(),$(this).ajaxSubmit({error:function(a){console.log("Error: "+a.status)},success:function(a){b.attr("src",$base.attr("href")+a.url),c.attr("data-url",a.url)}})})},b.createArticle=function(){$(".create-article-button").click(function(){$(this),c.emit("create-article-button",{title:$("#create-article-title").val(),urn:$(".no-article").data("urn")})})},b.deleteArticle=function(){var a=$(".delete-article-button");a.click(function(){window.prompt(a.data("prompt"),""),c.emit("delete-article-button",{urn:$("article.article").data("urn")})})},b.listeningDeleteArticle=function(){c.on("delete-article-button",function(a){location.href=$base.attr("href")+a.urn+"/"})},b.updateArticle=function(){function q(a){a.parents("li:first").remove()}var j,k,m,n,a=$(".content h1"),b=$(".text"),d=$(".categories h3"),e=$(".categories li"),f=$(".published a"),g=$("article.article"),h=$(".script"),i=$(".stylesheet"),l=$('<select class="field-categories">'),o=".categories select option",p=$(".categories ul");c.on("update-article-load-content",function(c){a.after($('<input type="text" class="field-title like-h1">').val(a.html())).css("display","none"),b.after($('<textarea class="field-script" cols="30" rows="10" placeholder="Script">Script</textarea>').val(h.html())).css("display","none"),b.after($('<textarea class="field-stylesheet" cols="30" rows="10" placeholder="Stylesheet"></textarea>').val(i.html())).css("display","none"),b.after('<span class="field-published"><input type="checkbox"> Visible ?</span>'),j=$(".field-published input"),j.attr("checked","true"===g.attr("data-published")),b.after('<span class="field-markdown"><input type="checkbox"> Markdown ?</span>'),k=$(".field-markdown input"),k.attr("checked","true"===g.attr("data-markdown")),b.after($('<textarea class="field-content" cols="30" rows="30"></textarea>').val(c.content)).css("display","none"),l.append($('<option value="">').text("----"));for(var r=0;r<c.categories.length;r++)l.append($('<option value="'+c.categories[r].urn+'">').text(c.categories[r].title));d.append(l),l.change(function(){$(o+":selected").each(function(){var a=$(this),b=!1,c=$(".categories li");""!==a.val()&&(b=!0,c.each(function(d){c.eq(d).data("urn")===a.val()&&(b=!1)}),b&&(n=$('<li data-urn="'+a.val()+'">').html('<a href="'+p.data("url").replace(/%urn%/g,a.val())+'" title="'+p.data("title")+" "+a.text()+'">'+a.text()+"</a><strong> X</strong></li>"),p.append(n),n.find("strong").click(function(){q($(this))})),$(o).removeAttr("selected"),$(o+'[value=""]').attr("selected","selected"))})}),e.append($("<strong>").text(" X")),m=$(".categories li strong"),m.click(function(){q($(this))}),website.jQueryUiLoading(function(){f.after($('<input type="text" class="field-date">').val(f.find("time").attr("datetime").replace("T"," ").replace(".000",""))).css("display","none"),p.sortable(),$(".field-date").datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:00",changeMonth:!0,changeYear:!0})})}),$(".update-article-button").click(function(){var b,d,e,f,h,a=$(this),i=[],l=$(".categories li");a.data("state")?(b=$(".field-title"),d=$(".field-content"),e=$(".field-date"),f=$(".field-script"),h=$(".field-stylesheet"),l.each(function(a){i.push(l.eq(a).data("urn"))}),c.emit("update-article-button",{urn:g.data("urn"),title:b.val(),content:d.val(),script:f.val(),stylesheet:h.val(),publishedDate:e.val(),categories:i,published:j.prop("checked"),markdown:k.prop("checked")}),a.data("state",!1)):(a.data("state",!0),c.emit("update-article-load-content",{urn:g.data("urn")}))})},b.listeningCreateArticle=function(){c.on("create-article-button",function(a){location.href=$base.attr("href")+a.urn+"/"})},b.listeningUpdateArticle=function(){var a=$(".content h1"),b=$("title"),d=$(".text"),e=$(".script"),f=$(".stylesheet"),g=$("article.article"),h=$(".published a");c.on("update-article-button-all",function(c){var m,i=new Date(c.publishedDate.replace(/ /g,"T")+".000+01:00"),j=website.module.extendedFormatDate(i,c.variation.dates),k=i.getMonth()+1,l=c.variation.listDate.linkMonth.title.replace(/%year%/g,i.getFullYear()).replace(/%month%/g,c.variation.dates.months[i.getMonth()]);k=(k.toString().length>1?"":"0")+k,m=c.variation.listDate.linkMonth.href.replace(/%year%/g,i.getFullYear()).replace(/%month%/g,k),0!==g.length&&(b.text(c.title.replace(/<\/?span>/g,"")),a.html(c.title),d.html(c.content)),h.find("time").html(j.string),h.find("time").attr("datetime",j.time),h.attr("title",l),h.attr("href",m),g.attr("data-markdown",c.markdown),g.attr("data-published",c.published),f.html(c.stylesheet),e.html(c.script),c.script&&(e.after($('<script class="script" type="text/javascript">').html(c.script)),e.remove()),website.prettifyLoad()}),c.on("update-article-button-others",function(a){var b=$("article.article");0!==b.length?a.published.toString()!==b.attr("data-published").toString()&&location.reload():a.published&&location.reload()}),c.on("update-article-button",function(){var b=$(".field-title"),c=$(".field-content"),e=$(".field-date"),f=$(".field-markdown"),g=$(".field-published"),i=$(".field-script"),j=$(".field-stylesheet"),k=$(".field-categories"),l=$(".categories li strong");a.css("display",""),d.css("display",""),h.css("display",""),b.remove(),c.remove(),e.remove(),g.remove(),i.remove(),j.remove(),k.remove(),l.remove(),f.remove()})},b.treeOfHeaders=function(a,c){function f(){"undefined"!=typeof d[e]&&"undefined"!=typeof d[e].headers&&(d[e].headers=b.treeOfHeaders(d[e].headers,c+1))}for(var d=[],e=-1,g=0;g<a.length;g++)a[g][0].nodeName==="H"+c&&(f(),e++,"undefined"==typeof d[e]&&(d[e]={}),d[e].header=a[g]),"undefined"!=typeof d[e]&&a[g][0].nodeName!=="H"+c&&("undefined"==typeof d[e].headers&&(d[e].headers=[]),d[e].headers.push(a[g]));return f(),d},b.constructSummary=function(a,c){for(var d,e,f,g=0;g<a.length;g++)f=$("<a>"),e=$("<li>"),d=$("<ul>"),f.text(a[g].header.text()),f.attr("title",a[g].header.text()),"H1"!==a[g].header[0].nodeName?f.attr("href",$(".permalink span").text()+"#"+a[g].header.attr("id")):f.attr("href",$(".permalink span").text()+"#content"),e.append(f),d.append(e),c.append(d),a[g].headers&&b.constructSummary(a[g].headers,e)},b.summary=function(){var a=[];$("article h1, article h2, article h3, article h4, article h5, article h6").each(function(){a.push($(this))}),b.constructSummary(b.treeOfHeaders(a,1),$(".summary"))},a.init=function(){b.createArticle(),b.listeningCreateArticle(),b.updateArticle(),b.listeningUpdateArticle(),b.deleteArticle(),b.listeningDeleteArticle(),b.summary(),website.disqusLoading()}}(website.article={}),function(a){"use strict";var b={},c=io.connect();b.accountLogin=function(){$(".account-login-button").click(function(){var a={email:$("#account-login-email").val(),password:$("#account-login-password").val()};c.emit("account-login",a)})},b.listeningAccountLogin=function(){c.on("account-login",function(a){a.authSuccess?location.reload():$(".submit .errors ").show()})},b.accountLogout=function(){$(".account-logout-button").click(function(){c.emit("account-logout",{})})},b.listeningAccountLogout=function(){c.on("account-logout",function(){location.reload()})},a.init=function(){b.accountLogin(),b.listeningAccountLogin(),b.accountLogout(),b.listeningAccountLogout()}}(website.login={}),$(function(){"use strict";var a=$body.attr("class").split(" ")[0].replace(/-/g,"");website.init(),void 0!==website[a]&&website[a].init()});